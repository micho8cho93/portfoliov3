---
import Layout from '../../components/Layout.astro';
import TagList from '../../components/TagList.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const projects = await getCollection('projects');
  return projects.map((project) => ({ params: { slug: project.slug }, props: { project } }));
}

const { project } = Astro.props;
const { Content } = await render(project);
---

<Layout title={`${project.data.title} | Projects`} description={project.data.description}>
  <p><a href="/projects">← Back to projects</a></p>
  <article>
    <h1>{project.data.title}</h1>
    <p>{project.data.description}</p>
    <p class="meta">{project.data.year} · {project.data.role}</p>
    <h2>Stack</h2>
    <TagList tags={project.data.stack} />
    <Content />

    {project.data.links && project.data.links.length > 0 && (
      <section>
        <h2>Links</h2>
        <ul>
          {project.data.links.map((link) => (
            <li>
              <a href={link.url} target="_blank" rel="noopener noreferrer">{link.label}</a>
            </li>
          ))}
        </ul>
      </section>
    )}
  </article>
</Layout>
