---
import { withBase } from '../../utils/withBase';
import { project as projectRoute } from '../../lib/routes';
import Layout from '../../components/Layout.astro';
import Card from '../../components/Card.astro';
import { getCollection } from 'astro:content';

const projects = (await getCollection('projects')).sort(
  (a, b) => Number(b.data.featured ?? false) - Number(a.data.featured ?? false) || b.data.year - a.data.year
);
---

<Layout title="Projects" description="Selected projects in CS education and developer tooling.">
  <h1>Projects</h1>
  <p class="measure">A collection of classroom-connected and tooling projects that support teaching and learning outcomes.</p>
  <section>
    <h2>Start here</h2>
    <ul>
      <li><a href={withBase('/teaching')}>See how projects support teaching</a></li>
      <li><a href={withBase('/learning')}>Explore student learning pathways</a></li>
      <li><a href={withBase('/contact')}>Discuss a project collaboration</a></li>
    </ul>
  </section>
  <div class="grid">
    {projects.map((projectItem) => (
      <Card
        title={projectItem.data.title}
        description={projectItem.data.description}
        href={withBase(projectRoute(projectItem.slug))}
        meta={`${projectItem.data.year} Â· ${projectItem.data.role}`}
        variant="project"
      />
    ))}
  </div>
  <p><a class="button" href={withBase('/contact')}>Contact about projects</a></p>
</Layout>
