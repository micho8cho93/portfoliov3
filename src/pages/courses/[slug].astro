---
import { withBase } from "../../utils/withBase";
import Layout from '../../components/Layout.astro';
import TagList from '../../components/TagList.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const courses = await getCollection('courses');
  return courses.map((course) => ({ params: { slug: course.slug }, props: { course } }));
}

const { course } = Astro.props;
const { Content } = await render(course);
---

<Layout title={`${course.data.title} | Courses`} description={course.data.description}>
  <p><a href={withBase("/courses")}>â† Back to courses</a></p>
  <div class="split">
    <article>
      <h1>{course.data.title}</h1>
      <p>{course.data.description}</p>
      <Content />
      <p><a class="button" href={withBase("/contact")}>Request syllabus</a></p>
    </article>
    <aside class="meta-card">
      <h2>Course details</h2>
      <ul>
        <li><strong>Level:</strong> {course.data.level}</li>
        <li><strong>Duration:</strong> {course.data.duration}</li>
        <li><strong>Audience:</strong> {course.data.audience}</li>
        <li><strong>Status:</strong> {course.data.status}</li>
        {course.data.startDate && <li><strong>Start date:</strong> {course.data.startDate.toLocaleDateString()}</li>}
      </ul>
      <h3>Topics</h3>
      <TagList tags={course.data.topics} />
    </aside>
  </div>
</Layout>
