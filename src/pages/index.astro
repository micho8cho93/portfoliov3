---
import Layout from '../components/Layout.astro';
import Card from '../components/Card.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('posts', ({ data }) => !data.draft))
  .sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime())
  .slice(0, 3);
const courses = (await getCollection('courses')).filter((item) => item.data.featured).slice(0, 3);
const projects = (await getCollection('projects'))
  .sort((a, b) => Number(b.data.featured ?? false) - Number(a.data.featured ?? false) || b.data.year - a.data.year)
  .slice(0, 3);
const resources = (await getCollection('resources')).slice(0, 3);

const personSchema = {
  '@context': 'https://schema.org',
  '@type': 'Person',
  name: 'Alex Morgan',
  jobTitle: 'CS Educator & Athletic Director',
  description: 'Computer science educator focused on equitable, project-based learning.',
  url: Astro.site
};

const websiteSchema = {
  '@context': 'https://schema.org',
  '@type': 'WebSite',
  name: 'Alex Morgan CS Education',
  url: Astro.site
};
---

<Layout
  title="Alex Morgan | CS Educator & Thought Leader"
  description="Teaching-focused portfolio and writing on computer science education."
>
  <section class="hero">
    <p class="eyebrow">CS Educator & Athletic Director</p>
    <h1>Helping students think like engineers, not just coders.</h1>
    <p>
      I design curriculum, courses, and tools that make computer science practical, rigorous, and human.
    </p>
    <div class="actions">
      <a class="button" href="/blog">Read the blog</a>
      <a class="button secondary" href="/contact">Book a workshop</a>
    </div>
  </section>

  <section>
    <h2>About</h2>
    <p>
      I teach CS through debugging routines, game design, and project-based assessment. My focus areas include
      introductory programming pedagogy, formative feedback systems, and teacher coaching.
    </p>
  </section>

  <section>
    <h2>Latest blog posts</h2>
    <div class="grid">
      {posts.map((post) => (
        <Card
          title={post.data.title}
          description={post.data.description}
          href={`/blog/${post.slug}`}
          meta={post.data.pubDate.toLocaleDateString()}
        />
      ))}
    </div>
  </section>

  <section>
    <h2>Featured courses</h2>
    <div class="grid">
      {courses.map((course) => (
        <Card
          title={course.data.title}
          description={course.data.description}
          href={`/courses/${course.slug}`}
          meta={`${course.data.level} · ${course.data.duration}`}
        />
      ))}
    </div>
  </section>

  <section>
    <h2>Projects</h2>
    <div class="grid">
      {projects.map((project) => (
        <Card
          title={project.data.title}
          description={project.data.description}
          href={`/projects/${project.slug}`}
          meta={`${project.data.year} · ${project.data.role}`}
        />
      ))}
    </div>
  </section>

  <section>
    <h2>Resources</h2>
    <div class="grid">
      {resources.map((resource) => (
        <Card
          title={resource.data.title}
          description={resource.data.description}
          href={`/resources/${resource.slug}`}
          meta={resource.data.type}
        />
      ))}
    </div>
  </section>

  <section class="cta-row">
    <a class="button" href="/courses">Courses</a>
    <a class="button" href="/projects">Projects</a>
    <a class="button" href="/resources">Resources</a>
    <a class="button" href="/contact">Contact</a>
  </section>

  <script type="application/ld+json" set:html={JSON.stringify(personSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(websiteSchema)} />
</Layout>
