---
import Layout from '../components/Layout.astro';
import HeroSection from '../components/sections/HeroSection.astro';
import ChoosePathSection from '../components/sections/ChoosePathSection.astro';
import ProofPracticeSection from '../components/sections/ProofPracticeSection.astro';
import PrinciplesSection from '../components/sections/PrinciplesSection.astro';
import ConversionBandSection from '../components/sections/ConversionBandSection.astro';
import { getCollection } from 'astro:content';

const courses = (await getCollection('courses'))
  .filter((item) => item.data.featured)
  .slice(0, 2);
const projects = (await getCollection('projects'))
  .sort(
    (a, b) =>
      Number(b.data.featured ?? false) - Number(a.data.featured ?? false) ||
      b.data.year - a.data.year
  )
  .slice(0, 2);
const resources = (await getCollection('resources')).slice(0, 2);

const personSchema = {
  '@context': 'https://schema.org',
  '@type': 'Person',
  name: 'Alex Morgan',
  jobTitle: 'CS Educator & Athletic Director',
  description: 'Computer science educator focused on equitable, project-based learning.',
  url: Astro.site
};

const websiteSchema = {
  '@context': 'https://schema.org',
  '@type': 'WebSite',
  name: 'Alex Morgan CS Education',
  url: Astro.site
};
---

<Layout
  title="Alex Morgan | CS Educator & Thought Leader"
  description="Teaching-focused portfolio and writing on computer science education."
>
  <HeroSection />
  <ChoosePathSection />
  <ProofPracticeSection
    coursesList={courses}
    projectsList={projects}
    resourcesList={resources}
    showViewAll={true}
  />
  <PrinciplesSection />
  <ConversionBandSection />

  <script type="application/ld+json" set:html={JSON.stringify(personSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(websiteSchema)} />
</Layout>
